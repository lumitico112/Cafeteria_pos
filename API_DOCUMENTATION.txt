# ========================================
# DOCUMENTACI√ìN API REST - SISTEMA POS CAFETER√çA
# Backend Spring Boot para Frontend Angular
# ========================================

## üöÄ INICIO R√ÅPIDO

1. Clonar proyecto: git clone <repo-url>
2. Crear .env: copy .env.example .env
3. Editar .env: configurar DB_PASSWORD y JWT_SECRET_KEY
4. Instalar: mvn clean install
5. Ejecutar: mvn spring-boot:run
6. Backend corriendo en: http://localhost:8080
7. Desarrollar frontend Angular en proyecto separado (puerto 4200)

Estado del Backend: ‚úÖ LISTO PARA DESARROLLO ANGULAR

## ‚ö†Ô∏è SEGURIDAD CR√çTICA - LEER PRIMERO

### 1. CONFIGURACI√ìN INICIAL DEL PROYECTO

**IMPORTANTE**: El archivo .env NO est√° incluido en el repositorio por seguridad.

PASOS OBLIGATORIOS ANTES DE INICIAR:

1. Copia el archivo .env.example a .env:
   Windows: copy .env.example .env
   Linux/Mac: cp .env.example .env

2. Genera una clave JWT SEGURA (ejecuta UNO de estos):
   
   # PowerShell (Windows):
   [Convert]::ToBase64String((1..32|%{Get-Random -Max 256}))
   
   # OpenSSL (Linux/Mac/Git Bash):
   openssl rand -base64 32
   
   # Node.js (cualquier plataforma):
   node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"

3. Edita el archivo .env y actualiza OBLIGATORIAMENTE:
   
   DB_PASSWORD=TU_PASSWORD_MYSQL_REAL
   JWT_SECRET_KEY=LA_CLAVE_GENERADA_EN_EL_PASO_2
   
   Ejemplo:
   DB_PASSWORD=DataBase_1.
   JWT_SECRET_KEY=WgBl1a4xhMCmurt65MB+Lg26u3OQt+n4tAI9ahDTs=

4. Valores opcionales que puedes ajustar en .env:
   - DB_HOST, DB_PORT, DB_NAME (si MySQL est√° en otro servidor)
   - FILE_UPLOAD_DIR (ruta donde se guardan im√°genes)
   - REPORTS_COMPANY_NAME, REPORTS_COMPANY_ADDRESS, etc.
   - CORS_ALLOWED_ORIGINS (URL de tu frontend Angular)

5. Descargar dependencias e instalar:
   mvn clean install

6. Ejecutar la aplicaci√≥n:
   mvn spring-boot:run
   
   O usar el IDE run/debug

### 2. GITIGNORE - PROTECCI√ìN AUTOM√ÅTICA

El archivo .gitignore YA est√° configurado y protege:
- ‚úÖ .env (NUNCA se subir√° a Git - cada desarrollador crea el suyo)
- ‚úÖ uploads/ (archivos subidos por usuarios)
- ‚úÖ temp/ y logs/ (archivos temporales)
- ‚úÖ target/ (archivos compilados)

VERIFICACI√ìN antes de cada commit:
git status
# El archivo .env NO debe aparecer en la lista
# Si aparece, el .gitignore tiene un error

### 3. ARQUITECTURA DEL SISTEMA

Spring Boot Backend (Puerto 8080):
- API REST pura (JSON)
- Autenticaci√≥n JWT
- Sin vistas HTML (solo endpoints)

Angular Frontend (Puerto 4200 - proyecto separado):
- Consumir√° la API REST
- Interfaz de usuario completa
- Comunicaci√≥n v√≠a HTTP + JWT

### 4. DEPENDENCIAS CLAVE

spring-dotenv (v4.0.0):
- Carga autom√°ticamente el archivo .env
- No requiere configuraci√≥n adicional
- Variables disponibles como ${VAR_NAME} en application.properties

spring-boot-starter-security + JWT:
- Autenticaci√≥n basada en tokens
- Sin sesiones (stateless)
- Tokens v√°lidos por 24 horas

iText7 (v7.2.5):
- Generaci√≥n de PDFs (boletas, reportes)

Apache POI (v5.2.3):
- Generaci√≥n y lectura de Excel
- Importaci√≥n/exportaci√≥n masiva

### 5. CHECKLIST DE SEGURIDAD PRE-PRODUCCI√ìN

Antes de desplegar a producci√≥n:
‚òê Generar nueva JWT_SECRET_KEY √∫nica (NUNCA usar la de desarrollo)
‚òê Usar contrase√±as fuertes de base de datos
‚òê Habilitar HTTPS/SSL (certificado v√°lido)
‚òê Configurar CORS solo para dominios autorizados de producci√≥n
‚òê Cambiar credenciales de usuarios por defecto (admin@cafeteria.com)
‚òê Implementar rate limiting para prevenir ataques
‚òê Verificar que .env NO existe en el repositorio: git ls-files | grep .env
‚òê Configurar backups autom√°ticos de base de datos
‚òê Habilitar logging de auditor√≠a en producci√≥n
‚òê Validar todos los inputs (ya implementado en backend)
‚òê Usar variables de entorno del sistema operativo en lugar de .env
‚òê Revisar y actualizar dependencias a √∫ltimas versiones seguras
‚òê Configurar firewall para MySQL (solo acceso desde backend)
‚òê Deshabilitar spring.jpa.show-sql=true en producci√≥n

## CONFIGURACI√ìN BASE
Base URL: http://localhost:8080
Content-Type: application/json
Authorization: Bearer {JWT_TOKEN}

## AUTENTICACI√ìN JWT

### 1. Login (POST /auth/login)
Endpoint: POST /auth/login
Autenticaci√≥n: No requerida (p√∫blico)
Content-Type: application/json

Request Body:
{
  "correo": "admin@cafeteria.com",
  "contrasena": "admin123"
}

Response Success (200):
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}

Response Error (401):
{
  "message": "Credenciales inv√°lidas"
}

### 2. Registro (POST /auth/register)
Endpoint: POST /auth/register
Autenticaci√≥n: No requerida (p√∫blico)
Content-Type: application/json

Request Body:
{
  "nombre": "Juan",
  "apellido": "P√©rez",
  "correo": "juan@example.com",
  "contrasena": "password123",
  "idRol": 3
}

Response Success (200):
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}

NOTA: idRol valores:
- 1 = ADMIN
- 2 = EMPLEADO
- 3 = CLIENTE

## ========================================
## GESTI√ìN DE CATEGOR√çAS
## ========================================

### 1. Listar Categor√≠as (GET /categorias)
Endpoint: GET /categorias
Autenticaci√≥n: Requerida (Bearer Token)
Roles: Todos

Response Success (200):
[
  {
    "idCategoria": 1,
    "nombre": "Bebidas Calientes",
    "descripcion": "Caf√©, t√©, chocolate"
  },
  {
    "idCategoria": 2,
    "nombre": "Bebidas Fr√≠as",
    "descripcion": "Jugos, smoothies, frappes"
  }
]

### 2. Obtener Categor√≠a por ID (GET /categorias/{id})
Endpoint: GET /categorias/{id}
Autenticaci√≥n: Requerida
Roles: Todos

Response Success (200):
{
  "idCategoria": 1,
  "nombre": "Bebidas Calientes",
  "descripcion": "Caf√©, t√©, chocolate"
}

### 3. Crear Categor√≠a (POST /categorias)
Endpoint: POST /categorias
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Request Body:
{
  "nombre": "Postres",
  "descripcion": "Pasteles y galletas"
}

Response Success (201):
{
  "idCategoria": 5,
  "nombre": "Postres",
  "descripcion": "Pasteles y galletas"
}

### 4. Actualizar Categor√≠a (PUT /categorias/{id})
Endpoint: PUT /categorias/{id}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Request Body:
{
  "nombre": "Postres Especiales",
  "descripcion": "Pasteles gourmet"
}

### 5. Eliminar Categor√≠a (DELETE /categorias/{id})
Endpoint: DELETE /categorias/{id}
Autenticaci√≥n: Requerida
Roles: ADMIN

Response Success (204): No Content

## ========================================
## GESTI√ìN DE PRODUCTOS
## ========================================

### 1. Listar Todos los Productos (GET /productos)
Endpoint: GET /productos
Autenticaci√≥n: Requerida
Roles: Todos

Response Success (200):
[
  {
    "idProducto": 1,
    "nombre": "Caf√© Americano",
    "descripcion": "Caf√© negro 8oz",
    "precio": 5.50,
    "imagenUrl": "cafe-americano.jpg",
    "estado": "DISPONIBLE",
    "idCategoria": 1,
    "nombreCategoria": "Bebidas Calientes",
    "cantidadActual": 100,
    "stockMinimo": 10,
    "unidadMedida": "unidad"
  }
]

### 2. Buscar Producto por ID (GET /productos/{id})
Endpoint: GET /productos/{id}
Autenticaci√≥n: Requerida
Roles: Todos

Response Success (200):
{
  "idProducto": 1,
  "nombre": "Caf√© Americano",
  "descripcion": "Caf√© negro 8oz",
  "precio": 5.50,
  "imagenUrl": "cafe-americano.jpg",
  "estado": "DISPONIBLE",
  "idCategoria": 1,
  "nombreCategoria": "Bebidas Calientes",
  "cantidadActual": 100,
  "stockMinimo": 10,
  "unidadMedida": "unidad"
}

### 3. Listar Productos por Categor√≠a (GET /productos/categoria/{idCategoria})
Endpoint: GET /productos/categoria/{idCategoria}
Autenticaci√≥n: Requerida
Roles: Todos

### 4. Listar Productos Disponibles (GET /productos/disponibles)
Endpoint: GET /productos/disponibles
Autenticaci√≥n: Requerida
Roles: Todos

### 5. Crear Producto (POST /productos)
Endpoint: POST /productos
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Request Body:
{
  "nombre": "Cappuccino",
  "descripcion": "Caf√© con leche espumosa",
  "precio": 7.50,
  "imagenUrl": "cappuccino.jpg",
  "idCategoria": 1,
  "cantidadActual": 50,
  "stockMinimo": 10,
  "unidadMedida": "unidad"
}

Response Success (201):
{
  "idProducto": 10,
  "nombre": "Cappuccino",
  ...
}

### 6. Actualizar Producto (PUT /productos/{id})
Endpoint: PUT /productos/{id}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Request Body: (mismo que crear)

### 7. Eliminar Producto (DELETE /productos/{id})
Endpoint: DELETE /productos/{id}
Autenticaci√≥n: Requerida
Roles: ADMIN

## ========================================
## GESTI√ìN DE USUARIOS
## ========================================

### 1. Listar Usuarios (GET /usuarios)
Endpoint: GET /usuarios
Autenticaci√≥n: Requerida
Roles: ADMIN

Response Success (200):
[
  {
    "idUsuario": 1,
    "nombre": "Admin",
    "apellido": "Sistema",
    "correo": "admin@cafeteria.com",
    "estado": "ACTIVO",
    "fechaCreacion": "2025-01-15T10:30:00",
    "idRol": 1,
    "nombreRol": "ADMIN",
    "telefono": "987654321",
    "direccion": "Av. Principal 123"
  }
]

### 2. Buscar Usuario por ID (GET /usuarios/{id})
Endpoint: GET /usuarios/{id}
Autenticaci√≥n: Requerida
Roles: ADMIN o el mismo usuario

### 3. Buscar Usuario por Email (GET /usuarios/email/{correo})
Endpoint: GET /usuarios/email/{correo}
Autenticaci√≥n: Requerida
Roles: ADMIN o el mismo usuario

### 4. Crear Usuario (POST /usuarios)
Endpoint: POST /usuarios
Autenticaci√≥n: Requerida
Roles: ADMIN

Request Body:
{
  "nombre": "Mar√≠a",
  "apellido": "Gonz√°lez",
  "correo": "maria@example.com",
  "contrasena": "pass123",
  "idRol": 2,
  "telefono": "987654321",
  "direccion": "Calle 123"
}

### 5. Actualizar Usuario (PUT /usuarios/{id})
Endpoint: PUT /usuarios/{id}
Autenticaci√≥n: Requerida
Roles: ADMIN o el mismo usuario

### 6. Eliminar Usuario (DELETE /usuarios/{id})
Endpoint: DELETE /usuarios/{id}
Autenticaci√≥n: Requerida
Roles: ADMIN

## ========================================
## GESTI√ìN DE PEDIDOS
## ========================================

### 1. Listar Todos los Pedidos (GET /pedidos)
Endpoint: GET /pedidos
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Response Success (200):
[
  {
    "idPedido": 1,
    "fecha": "2025-11-26T14:30:00",
    "estado": "COMPLETADO",
    "tipoEntrega": "LOCAL",
    "total": 25.50,
    "idUsuario": 3,
    "nombreCliente": "Juan P√©rez",
    "idEmpleado": 2,
    "nombreEmpleado": "Mar√≠a L√≥pez",
    "detalles": [
      {
        "idDetallePedido": 1,
        "idProducto": 1,
        "nombreProducto": "Caf√© Americano",
        "cantidad": 2,
        "precioUnitario": 5.50,
        "subtotal": 11.00
      },
      {
        "idDetallePedido": 2,
        "idProducto": 5,
        "nombreProducto": "Croissant",
        "cantidad": 3,
        "precioUnitario": 4.50,
        "subtotal": 13.50
      }
    ]
  }
]

### 2. Listar Pedidos por Usuario (GET /pedidos/usuario/{idUsuario})
Endpoint: GET /pedidos/usuario/{idUsuario}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO o el mismo usuario

### 3. Listar Pedidos por Estado (GET /pedidos/estado/{estado})
Endpoint: GET /pedidos/estado/{estado}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Estados v√°lidos: PENDIENTE, EN_PROCESO, COMPLETADO, CANCELADO

### 4. Buscar Pedido por ID (GET /pedidos/{id})
Endpoint: GET /pedidos/{id}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO o propietario del pedido

### 5. Crear Pedido (POST /pedidos)
Endpoint: POST /pedidos
Autenticaci√≥n: Requerida
Roles: Todos

Request Body:
{
  "idUsuario": 3,
  "tipoEntrega": "DOMICILIO",
  "detalles": [
    {
      "idProducto": 1,
      "cantidad": 2
    },
    {
      "idProducto": 5,
      "cantidad": 1
    }
  ]
}

Response Success (201):
{
  "idPedido": 15,
  "fecha": "2025-11-26T19:00:00",
  "estado": "PENDIENTE",
  "tipoEntrega": "DOMICILIO",
  "total": 15.50,
  ...
}

### 6. Cambiar Estado de Pedido (PUT /pedidos/{id}/estado)
Endpoint: PUT /pedidos/{id}/estado
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Request Body:
{
  "estado": "EN_PROCESO"
}

## ========================================
## GESTI√ìN DE INVENTARIO
## ========================================

### 1. Listar Todo el Inventario (GET /inventario)
Endpoint: GET /inventario
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Response Success (200):
[
  {
    "idInventario": 1,
    "producto": {
      "idProducto": 1,
      "nombre": "Caf√© Americano"
    },
    "cantidadActual": 100,
    "stockMinimo": 10,
    "unidadMedida": "unidad",
    "fechaActualizacion": "2025-11-26T10:00:00"
  }
]

### 2. Buscar Inventario por Producto (GET /inventario/producto/{idProducto})
Endpoint: GET /inventario/producto/{idProducto}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

### 3. Listar Productos con Stock Bajo (GET /inventario/bajo-stock)
Endpoint: GET /inventario/bajo-stock
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

### 4. Actualizar Stock (PUT /inventario/{id})
Endpoint: PUT /inventario/{id}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Request Body:
{
  "cantidadActual": 150,
  "stockMinimo": 15
}

## ========================================
## GESTI√ìN DE PROMOCIONES
## ========================================

### 1. Listar Promociones (GET /promociones)
Endpoint: GET /promociones
Autenticaci√≥n: Requerida
Roles: Todos

Response Success (200):
[
  {
    "idPromocion": 1,
    "nombre": "Happy Hour Caf√©",
    "descripcion": "20% descuento en caf√©s de 3pm a 5pm",
    "porcentajeDescuento": 20.0,
    "fechaInicio": "2025-11-01T00:00:00",
    "fechaFin": "2025-11-30T23:59:59",
    "imagenUrl": "promo-cafe.jpg",
    "estado": "ACTIVA"
  }
]

### 2. Listar Promociones Activas (GET /promociones/activas)
Endpoint: GET /promociones/activas
Autenticaci√≥n: Requerida
Roles: Todos

### 3. Crear Promoci√≥n (POST /promociones)
Endpoint: POST /promociones
Autenticaci√≥n: Requerida
Roles: ADMIN

Request Body:
{
  "nombre": "Descuento Fin de Semana",
  "descripcion": "15% off en todo",
  "porcentajeDescuento": 15.0,
  "fechaInicio": "2025-12-01T00:00:00",
  "fechaFin": "2025-12-31T23:59:59",
  "imagenUrl": "promo-weekend.jpg"
}

### 4. Actualizar Promoci√≥n (PUT /promociones/{id})
Endpoint: PUT /promociones/{id}
Autenticaci√≥n: Requerida
Roles: ADMIN

### 5. Eliminar Promoci√≥n (DELETE /promociones/{id})
Endpoint: DELETE /promociones/{id}
Autenticaci√≥n: Requerida
Roles: ADMIN

## ========================================
## GESTI√ìN DE ARCHIVOS
## ========================================

### 1. Subir Archivo (POST /files/upload)
Endpoint: POST /files/upload
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO
Content-Type: multipart/form-data

Request Body (FormData):
file: <archivo binario>

Response Success (200):
{
  "filename": "a1b2c3d4-e5f6-7890-abcd-ef1234567890.jpg",
  "message": "Archivo subido exitosamente"
}

Tipos permitidos: image/jpeg, image/png, image/jpg, image/gif
Tama√±o m√°ximo: 10MB

### 2. Descargar Archivo (GET /files/download/{filename})
Endpoint: GET /files/download/{filename}
Autenticaci√≥n: No requerida (p√∫blico)

Response Success (200):
Content-Type: application/octet-stream
Body: <archivo binario>

### 3. Eliminar Archivo (DELETE /files/{filename})
Endpoint: DELETE /files/{filename}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Response Success (200):
{
  "message": "Archivo eliminado exitosamente"
}

## ========================================
## REPORTES
## ========================================

### 1. Generar Boleta PDF (GET /reportes/boleta/{pedidoId})
Endpoint: GET /reportes/boleta/{pedidoId}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Response Success (200):
Content-Type: application/pdf
Content-Disposition: attachment; filename="boleta_15.pdf"
Body: <PDF binario>

### 2. Generar Ticket ASCII (GET /reportes/ticket/{pedidoId})
Endpoint: GET /reportes/ticket/{pedidoId}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Response Success (200):
Content-Type: text/plain
Content-Disposition: attachment; filename="ticket_15.txt"
Body: <Texto ASCII>

### 3. Reporte de Pedidos (GET /reportes/pedidos)
Endpoint: GET /reportes/pedidos?fechaInicio={ISO}&fechaFin={ISO}&estado={ESTADO}&idUsuario={ID}&formato={PDF|EXCEL}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

Query Parameters (todos opcionales):
- fechaInicio: 2025-01-01T00:00:00
- fechaFin: 2025-12-31T23:59:59
- estado: PENDIENTE|EN_PROCESO|COMPLETADO|CANCELADO
- idUsuario: 3
- formato: PDF o EXCEL (default: PDF)

Response Success (200):
Content-Type: application/pdf o application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
Content-Disposition: attachment; filename="reporte_pedidos.pdf"

### 4. Reporte de Productos (GET /reportes/productos)
Endpoint: GET /reportes/productos?idCategoria={ID}&formato={PDF|EXCEL}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

### 5. Reporte de Usuarios (GET /reportes/usuarios)
Endpoint: GET /reportes/usuarios?formato={PDF|EXCEL}
Autenticaci√≥n: Requerida
Roles: ADMIN

### 6. Reporte de Inventario (GET /reportes/inventario)
Endpoint: GET /reportes/inventario?formato={PDF|EXCEL}
Autenticaci√≥n: Requerida
Roles: ADMIN, EMPLEADO

## ========================================
## OPERACIONES MASIVAS (BULK)
## ========================================

### 1. Importar Usuarios desde Excel (POST /bulk/usuarios/import)
Endpoint: POST /bulk/usuarios/import
Autenticaci√≥n: Requerida
Roles: ADMIN
Content-Type: multipart/form-data

Request Body (FormData):
file: <archivo .xlsx>

Response Success (200):
{
  "success": 45,
  "errors": 2,
  "errorDetails": [
    "Fila 10: Email duplicado",
    "Fila 25: Rol inv√°lido"
  ],
  "message": "Importados: 45, Errores: 2"
}

### 2. Importar Productos desde Excel (POST /bulk/productos/import)
Endpoint: POST /bulk/productos/import
Autenticaci√≥n: Requerida
Roles: ADMIN
Content-Type: multipart/form-data

Request Body (FormData):
file: <archivo .xlsx>

Response Success (200):
{
  "success": 120,
  "errors": 0,
  "errorDetails": [],
  "message": "Importados: 120, Errores: 0"
}

### 3. Descargar Plantilla de Usuarios (GET /bulk/template/usuarios)
Endpoint: GET /bulk/template/usuarios
Autenticaci√≥n: Requerida
Roles: ADMIN

Response Success (200):
Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
Content-Disposition: attachment; filename="plantilla_usuarios.xlsx"

### 4. Descargar Plantilla de Productos (GET /bulk/template/productos)
Endpoint: GET /bulk/template/productos
Autenticaci√≥n: Requerida
Roles: ADMIN

## ========================================
## DASHBOARD ADMINISTRATIVO
## ========================================

### 1. Obtener Estad√≠sticas del Dashboard (GET /admin/dashboard)
Endpoint: GET /admin/dashboard
Autenticaci√≥n: Requerida
Roles: ADMIN

Response Success (200):
{
  "totalUsuarios": 45,
  "totalProductos": 120,
  "totalPedidos": 350,
  "ventasHoy": 1500.50,
  "ventasMes": 45000.00,
  "pedidosPendientes": 8
}

## ========================================
## CONFIGURACI√ìN CORS PARA ANGULAR
## ========================================

El backend debe configurar CORS para permitir requests desde Angular.

Configuraci√≥n necesaria en SecurityConfig.java:

@Bean
public CorsConfigurationSource corsConfigurationSource() {
    CorsConfiguration configuration = new CorsConfiguration();
    configuration.setAllowedOrigins(Arrays.asList("http://localhost:4200"));
    configuration.setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE", "OPTIONS"));
    configuration.setAllowedHeaders(Arrays.asList("*"));
    configuration.setAllowCredentials(true);
    
    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
    source.registerCorsConfiguration("/**", configuration);
    return source;
}

## ========================================
## MANEJO DE ERRORES
## ========================================

Respuestas de error est√°ndar:

400 Bad Request:
{
  "message": "Datos inv√°lidos",
  "errors": ["El campo nombre es requerido"]
}

401 Unauthorized:
{
  "message": "No autorizado",
  "error": "Token JWT inv√°lido o expirado"
}

403 Forbidden:
{
  "message": "Acceso denegado",
  "error": "No tienes permisos para esta operaci√≥n"
}

404 Not Found:
{
  "message": "Recurso no encontrado",
  "error": "El producto con ID 999 no existe"
}

500 Internal Server Error:
{
  "message": "Error interno del servidor",
  "error": "Detalles del error..."
}

## ========================================
## FLUJO DE AUTENTICACI√ìN EN ANGULAR
## ========================================

1. Usuario hace login en /auth/login
2. Backend retorna JWT token
3. Angular guarda el token en localStorage o sessionStorage
4. Para cada request subsecuente, Angular incluye el header:
   Authorization: Bearer {token}
5. Backend valida el token en cada request
6. Si el token expira (24 horas), usuario debe hacer login nuevamente

Ejemplo en Angular:

// auth.service.ts
login(correo: string, contrasena: string) {
  return this.http.post<{token: string}>('http://localhost:8080/auth/login', {
    correo,
    contrasena
  }).pipe(
    tap(response => {
      localStorage.setItem('token', response.token);
    })
  );
}

// http.interceptor.ts
intercept(request: HttpRequest<any>, next: HttpHandler) {
  const token = localStorage.getItem('token');
  if (token) {
    request = request.clone({
      setHeaders: {
        Authorization: `Bearer ${token}`
      }
    });
  }
  return next.handle(request);
}

## ========================================
## VARIABLES DE ENTORNO PARA ANGULAR
## ========================================

environment.ts (desarrollo):
export const environment = {
  production: false,
  apiUrl: 'http://localhost:8080',
  fileUploadMaxSize: 10485760, // 10MB
  allowedImageTypes: ['image/jpeg', 'image/png', 'image/jpg', 'image/gif'],
  jwtTokenKey: 'cafeteria_jwt_token'
};

environment.prod.ts (producci√≥n):
export const environment = {
  production: true,
  apiUrl: 'https://api.cafeteria.com',
  fileUploadMaxSize: 10485760,
  allowedImageTypes: ['image/jpeg', 'image/png', 'image/jpg', 'image/gif'],
  jwtTokenKey: 'cafeteria_jwt_token'
};

## ========================================
## MODELOS/INTERFACES TYPESCRIPT PARA ANGULAR
## ========================================

// models/usuario.model.ts
export interface Usuario {
  idUsuario?: number;
  nombre: string;
  apellido: string;
  correo: string;
  contrasena?: string;
  estado?: 'ACTIVO' | 'INACTIVO';
  fechaCreacion?: Date;
  idRol: number;
  nombreRol?: string;
  telefono?: string;
  direccion?: string;
}

// models/producto.model.ts
export interface Producto {
  idProducto?: number;
  nombre: string;
  descripcion?: string;
  precio: number;
  imagenUrl?: string;
  estado?: 'DISPONIBLE' | 'AGOTADO' | 'DESCONTINUADO';
  idCategoria: number;
  nombreCategoria?: string;
  cantidadActual?: number;
  stockMinimo?: number;
  unidadMedida?: string;
}

// models/pedido.model.ts
export interface Pedido {
  idPedido?: number;
  fecha?: Date;
  estado?: 'PENDIENTE' | 'EN_PROCESO' | 'COMPLETADO' | 'CANCELADO';
  tipoEntrega: 'LOCAL' | 'DOMICILIO';
  total?: number;
  idUsuario: number;
  nombreCliente?: string;
  idEmpleado?: number;
  nombreEmpleado?: string;
  detalles: DetallePedido[];
}

export interface DetallePedido {
  idDetallePedido?: number;
  idProducto: number;
  nombreProducto?: string;
  cantidad: number;
  precioUnitario?: number;
  subtotal?: number;
}

// models/categoria.model.ts
export interface Categoria {
  idCategoria?: number;
  nombre: string;
  descripcion?: string;
}

// models/promocion.model.ts
export interface Promocion {
  idPromocion?: number;
  nombre: string;
  descripcion?: string;
  porcentajeDescuento: number;
  fechaInicio: Date;
  fechaFin: Date;
  imagenUrl?: string;
  estado?: 'ACTIVA' | 'INACTIVA';
}

// models/auth.model.ts
export interface LoginRequest {
  correo: string;
  contrasena: string;
}

export interface RegisterRequest {
  nombre: string;
  apellido: string;
  correo: string;
  contrasena: string;
  idRol: number;
}

export interface AuthResponse {
  token: string;
}

## ========================================
## ESTRUCTURA DE CARPETAS RECOMENDADA PARA ANGULAR
## ========================================

src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ core/                    # Servicios singleton, guards, interceptors
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ guards/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.guard.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ role.guard.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ interceptors/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt.interceptor.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ error.interceptor.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ auth.service.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ storage.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ shared/                  # Componentes, directivas, pipes compartidos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ directives/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pipes/
‚îÇ   ‚îú‚îÄ‚îÄ models/                  # Interfaces y modelos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usuario.model.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ producto.model.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pedido.model.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ services/               # Servicios de features
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ producto.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pedido.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usuario.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ categoria.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ promocion.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventario.service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reporte.service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ file.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ pages/                  # P√°ginas/Vistas principales
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ register/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ productos/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pedidos/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usuarios/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventario/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ promociones/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reportes/
‚îÇ   ‚îî‚îÄ‚îÄ app.component.ts
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îî‚îÄ‚îÄ icons/
‚îî‚îÄ‚îÄ environments/
    ‚îú‚îÄ‚îÄ environment.ts
    ‚îî‚îÄ‚îÄ environment.prod.ts

## ========================================
## CONSIDERACIONES DE SEGURIDAD
## ========================================

1. NUNCA almacenar contrase√±as en texto plano
2. Validar SIEMPRE los datos del lado del servidor (el backend ya lo hace)
3. Usar HTTPS en producci√≥n
4. Implementar rate limiting para prevenir ataques de fuerza bruta
5. Validar el token JWT en cada request
6. Sanitizar inputs para prevenir XSS
7. Implementar CORS correctamente
8. No exponer informaci√≥n sensible en mensajes de error

## ========================================
## PR√ìXIMOS PASOS RECOMENDADOS
## ========================================

1. Configurar proyecto Angular con Angular CLI
2. Instalar dependencias necesarias (HttpClient, Forms, Router)
3. Crear servicios para cada entidad
4. Implementar guards para proteger rutas
5. Crear interceptors para JWT y manejo de errores
6. Desarrollar componentes de UI
7. Implementar formularios reactivos
8. Agregar validaciones del lado del cliente
9. Crear m√≥dulo de reportes con descarga de archivos
10. Implementar paginaci√≥n y b√∫squeda en tablas
11. Agregar notificaciones Toast/Snackbar
12. Optimizar con lazy loading de m√≥dulos
13. Implementar PWA para uso offline (opcional)
14. Agregar pruebas unitarias y E2E

## ========================================
## COMANDOS √öTILES PARA DESARROLLO
## ========================================

# Iniciar backend Spring Boot
cd cafeteria
mvn spring-boot:run

# Crear proyecto Angular
ng new cafeteria-frontend
cd cafeteria-frontend
ng serve

# Generar servicios
ng generate service services/producto
ng generate service services/pedido
ng generate service services/auth

# Generar componentes
ng generate component pages/productos
ng generate component pages/pedidos

# Generar guards
ng generate guard core/guards/auth

# Build para producci√≥n
ng build --prod

## ========================================
## CONTACTO Y SOPORTE
## ========================================

Backend API: http://localhost:8080
Swagger/API Docs: (pendiente de implementar)
Database: MySQL en localhost:3306/sistema_pos

Credenciales de prueba:
Admin:
  Email: admin@cafeteria.com
  Password: admin123

Empleado:
  Email: empleado@cafeteria.com
  Password: empleado123

Cliente:
  Email: cliente@cafeteria.com
  Password: cliente123

## FIN DE LA DOCUMENTACI√ìN
